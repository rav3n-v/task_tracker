{% extends 'base.html' %}

{% block body_attrs %}data-initial-route="{{ active_route|default('dashboard') }}"{% endblock %}

{% block content %}
  <a class="skip-link" href="#mainContent">Skip to main content</a>
  

  <div id="appLayout" class="layout">
    <aside class="sidebar" aria-label="Primary">
      <div class="brand">⚛️ <span>CSIR NET Tracker</span></div>
      <div class="auth-userbar"><span id="userDisplay"></span><button id="logoutBtn" type="button">Logout</button></div>
      <nav class="nav-links" aria-label="Sections">
  <a href="/dashboard" data-route="dashboard">Dashboard</a>
<a href="/plan" data-route="plan">Daily Planner</a>
<a href="/routine" data-route="routine">Daily Routine</a>
<a href="/session" data-route="session">Study Session</a>
<a href="/tests" data-route="tests">Practice Tests</a>
<a href="/downloads" data-route="downloads">Downloads</a>
<a href="/analytics" data-route="analytics">Analytics</a>
<a href="/resources" data-route="resources">Resources</a>
<a href="/settings" data-route="settings">Settings</a>

<a href="/syllabus" data-route="syllabus">Syllabus</a>
<a href="/score-predictor" data-route="score-predictor">Score Predictor</a>
</nav>
      <div class="sidebar-footer" aria-live="polite">
        <p id="daysComplete">0/60</p>
        <small>DAYS COMPLETE</small>
        <p id="trackedMinutes">{{ total_tracked_minutes }}m</p>
        <small>TOTAL TRACKED</small>
      </div>
    </aside>

    <main id="mainContent" class="content">
      <div class="timer-widget" role="region" aria-label="Study timer">
        <h3 id="timerDisplay">00:00:00</h3>
        <p>STUDY TIME</p>
        <div class="timer-actions" aria-label="Timer actions">
          <button id="timerStart" type="button" aria-label="Start timer">▶</button>
          <button id="timerPause" type="button" aria-label="Pause timer">⏸</button>
          <button id="timerReset" type="button" aria-label="Reset timer">⏹</button>
        </div>
      </div>

      <section id="dashboardView" class="view">
        <h1>Dashboard</h1>

        <div class="status-strip" role="status" aria-live="polite">
          <span id="lastLogin">Last Login: Just now</span>
          <span id="currentDate"></span>
          <span id="streakText">Study Streak: {{ study_streak }} days</span>
        </div>

        <article class="countdown-card">
          <div>
            <h2>CSIR NET Exam Countdown</h2>
          </div>
          <div class="countdown-values" aria-label="Exam countdown values">
            <div><strong id="countDays">{{ "%02d"|format(countdown.days) }}</strong><span>DAYS</span></div>
            <div><strong id="countHours">{{ "%02d"|format(countdown.hours) }}</strong><span>HOURS</span></div>
            <div><strong id="countMinutes">{{ "%02d"|format(countdown.minutes) }}</strong><span>MINUTES</span></div>
          </div>
          <div class="target-date" id="targetDate">Target Exam: {{ target_exam or "Not set" }}</div>
        </article>

        <div class="cards-grid" id="dashboardCards"></div>
      </section>

      <section id="planView" class="view">
        <h1>Daily Planner</h1>
        <p class="subtitle">Create and track unit-wise tasks with due dates.</p>

        <div class="panel daily-planner-panel">
          <div class="daily-planner-input-row">
            <input id="dailyTaskTitle" type="text" placeholder="Add a task for today" autocomplete="off" />
            <button id="addDailyTaskBtn" type="button">Add Task</button>
          </div>
          <p id="dailyPlannerMeta" class="subtitle">0/0 completed · 0% complete</p>
          <div class="metric-bar"><span id="dailyPlannerProgressBar" style="width: 0%;"></span></div>
          <p id="dailyPlannerStreak" class="subtitle">Streak: 0 days</p>
          <div id="dailyPlannerList" class="task-list" aria-live="polite"></div>
        </div>
</section>

      <section id="routineView" class="view">
        <h1>Daily Routine</h1>
        <p class="subtitle">Fixed routine blocks with daily completion tracking.</p>

        <div class="two-stats">
          <article><h3 id="hoursToday">{{ today_hours }}</h3><p>Hours Studied Today</p></article>
          <article><h3 id="hoursWeek">{{ week_hours }}</h3><p>Hours This Week</p></article>
        </div>

        <p id="routineProgress" class="subtitle">0/0 completed · 0%</p>
        <div class="metric-bar"><span id="routineProgressBar" style="width: 0%;"></span></div>
        <div id="routineList" class="routine-list"></div>
      </section>

      <section id="sessionView" class="view">
        <h1>Study Session</h1>
        <p class="subtitle">Use the timer and complete routine tasks to maintain focus.</p>
        <div class="panel">
          <p>Tip: Start the timer before each focused study block and mark routine checkboxes as you complete them.</p>
        </div>
      </section>

      <section id="testsView" class="view">
        <h1>Practice Tests</h1>
        <p class="subtitle">Track attempts and scores for 10 mock tests.</p>
        <div id="mockStats" class="three-stats"></div>
        <div id="mockTestsList" class="task-list"></div>
      </section>

      <section id="downloadsView" class="view">
        <h1>Downloads</h1>
        <p class="subtitle">Quick links to useful files.</p>
        <div class="panel list-grid" id="downloadList"></div>
      </section>

      <section id="analyticsView" class="view">
        <h1>Analytics</h1>
        <p class="subtitle">Unified performance summary across planner, routine, tests, and syllabus.</p>
        <div id="analyticsSummaryGrid" class="cards-grid"></div>
      </section>

      <section id="resourcesView" class="view">
        <h1>Resources</h1>
        <p class="subtitle">Important topics organized by syllabus unit.</p>
        <div id="resourceList" class="panel list-grid"></div>
      </section>
      <section id="syllabusView" class="view">
  <h1>Syllabus Tracker</h1>
  <p class="subtitle">Track theory, PYQ and revisions.</p>
{% include "partials/syllabus_content.html" %}
</section>
      <section id="scorePredictorView" class="view">
  <h1>Weighted Score Predictor</h1>
  <p class="subtitle">
    Subject-wise CSIR NET Mathematics projection with aptitude baseline.
  </p>

  {% include "partials/score_predictor_content.html" %}
</section>

      <section id="settingsView" class="view">
        <h1>Settings</h1>
        <p class="subtitle">Set exam date, daily goal, and theme.</p>
        <form id="settingsForm" class="panel form-grid compact">
          <label for="settingExamDate">Exam date</label>
          <input id="settingExamDate" type="date" />

          <label for="settingDailyGoal">Daily goal (tasks)</label>
          <input id="settingDailyGoal" type="number" min="1" max="20" />

          <label for="settingTheme">Theme</label>
          <select id="settingTheme">
            <option value="dark">Dark</option>
            <option value="light">Light</option>
          </select>

          <button type="submit">Save Settings</button>
        </form>
        <p id="settingsMessage" class="subtitle"></p>
      </section>
    </main>
  </div>

{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/app.js') }}"></script>
{% endblock %}
